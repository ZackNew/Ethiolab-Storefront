{"code":"import { __assign } from \"tslib\";\r\nimport { Logger } from '@vue-storefront/core';\r\nimport { setContext } from 'apollo-link-context';\r\nexport var handleRetry = function () { return function (count, operation, error) {\r\n    var _a;\r\n    if (count > 3) {\r\n        return false;\r\n    }\r\n    if (((_a = error === null || error === void 0 ? void 0 : error.result) === null || _a === void 0 ? void 0 : _a.message) === 'invalid_token') {\r\n        // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\r\n        Logger.debug(\"Apollo retry-link, the operation (\" + operation.operationName + \") sent with wrong token, creating a new one... (attempt: \" + count + \")\");\r\n        return true;\r\n    }\r\n    return false;\r\n}; };\r\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\nexport var authLinkFactory = function (_a) {\r\n    var auth = _a.auth;\r\n    return setContext(function (apolloReq, _a) {\r\n        var headers = _a.headers;\r\n        Logger.debug('Apollo authLinkFactory', apolloReq.operationName);\r\n        var token = auth.getAuthCookie();\r\n        if (token) {\r\n            Logger.debug('Apollo authLinkFactory, finished, token: ', token);\r\n        }\r\n        return {\r\n            headers: __assign(__assign({}, headers), { authorization: token ? \"Bearer \" + token : '' })\r\n        };\r\n    });\r\n};\r\n//# sourceMappingURL=linkHandlers.js.map","references":["/home/eb/projs/eecommerce.web/ecommerce.web/node_modules/@vue-storefront/core/lib/src/index.d.ts","/home/eb/projs/eecommerce.web/ecommerce.web/node_modules/apollo-link-context/lib/index.d.ts","/home/eb/projs/eecommerce.web/ecommerce.web/packages/api-client/src/types/setup.ts"],"map":"{\"version\":3,\"file\":\"linkHandlers.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/helpers/vendureLink/linkHandlers.ts\"],\"names\":[],\"mappings\":\";AAAA,OAAO,EAAE,MAAM,EAAE,MAAM,sBAAsB,CAAC;AAC9C,OAAO,EAAE,UAAU,EAAE,MAAM,qBAAqB,CAAC;AAGjD,MAAM,CAAC,IAAM,WAAW,GAAG,cAAM,OAAA,UAAC,KAAa,EAAE,SAAkC,EAAE,KAAwC;;IAC3H,IAAI,KAAK,GAAG,CAAC,EAAE;QACb,OAAO,KAAK,CAAC;KACd;IAED,IAAI,CAAA,MAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,MAAM,0CAAE,OAAO,MAAK,eAAe,EAAE;QAC9C,4EAA4E;QAC5E,MAAM,CAAC,KAAK,CAAC,uCAAqC,SAAS,CAAC,aAAa,iEAA4D,KAAK,MAAG,CAAC,CAAC;QAC/I,OAAO,IAAI,CAAC;KACb;IAED,OAAO,KAAK,CAAC;AACf,CAAC,EAZgC,CAYhC,CAAC;AAEF,6EAA6E;AAC7E,MAAM,CAAC,IAAM,eAAe,GAAG,UAAC,EAE/B;QAFiC,IAAI,UAAA;IAEhC,OAAA,UAAU,CAAC,UAAC,SAAS,EAAE,EAAW;YAAT,OAAO,aAAA;QACpC,MAAM,CAAC,KAAK,CAAC,wBAAwB,EAAE,SAAS,CAAC,aAAa,CAAC,CAAC;QAChE,IAAM,KAAK,GAAW,IAAI,CAAC,aAAa,EAAE,CAAC;QAE3C,IAAI,KAAK,EAAE;YACT,MAAM,CAAC,KAAK,CAAC,2CAA2C,EAAE,KAAK,CAAC,CAAC;SAClE;QAED,OAAO;YACL,OAAO,wBACF,OAAO,KACV,aAAa,EAAE,KAAK,CAAC,CAAC,CAAC,YAAU,KAAO,CAAC,CAAC,CAAC,EAAE,GAC9C;SACF,CAAC;IACJ,CAAC,CAAC;AAdI,CAcJ,CAAC\"}","dtsmap":{"name":"/home/eb/projs/eecommerce.web/ecommerce.web/packages/api-client/lib/helpers/vendureLink/linkHandlers.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"linkHandlers.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/helpers/vendureLink/linkHandlers.ts\"],\"names\":[],\"mappings\":\"AAEA,OAAO,EAAE,WAAW,EAAE,MAAM,mBAAmB,CAAC;AAEhD,eAAO,MAAM,WAAW,gBAAiB,MAAM,aAAa;IAAE,aAAa,EAAE,GAAG,CAAC;CAAE,SAAS;IAAE,MAAM,EAAE;QAAE,OAAO,EAAE,MAAM,CAAC;KAAE,CAAC;CAAE,KAAG,OAY/H,CAAC;AAGF,eAAO,MAAM,eAAe;UACpB,WAAW;sCAejB,CAAC\"}"},"dts":{"name":"/home/eb/projs/eecommerce.web/ecommerce.web/packages/api-client/lib/helpers/vendureLink/linkHandlers.d.ts","writeByteOrderMark":false,"text":"import { AuthMethods } from '../../types/setup';\r\nexport declare const handleRetry: () => (count: number, operation: {\r\n    operationName: any;\r\n}, error: {\r\n    result: {\r\n        message: string;\r\n    };\r\n}) => boolean;\r\nexport declare const authLinkFactory: ({ auth }: {\r\n    auth: AuthMethods;\r\n}) => import(\"apollo-link\").ApolloLink;\r\n//# sourceMappingURL=linkHandlers.d.ts.map"}}
